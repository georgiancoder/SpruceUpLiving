<header class="sticky top-0 z-50 bg-amber-100/90 backdrop-blur-xl border-b border-amber-200/50 supports-backdrop-blur:bg-amber-100/90">
  <!-- state: pure Tailwind (peer) -->
  <input id="mobile-nav" type="checkbox" class="peer hidden" aria-hidden="true" />

  <div class="max-w-7xl mx-auto px-5 sm:px-6 lg:px-8 py-3.5 flex items-center justify-between gap-4">
    <!-- Brand -->
    <a href="#" class="flex items-center gap-2 group">
      <!-- replace /assets/logo.png with your actual logo path if different -->
      <img
        src="logo.jpg"
        alt="Spruce Up Living logo"
        class="w-14 h-14 rounded-full object-cover shadow-md group-hover:shadow-lg transition-shadow duration-200"
      />
      <span class="text-2xl font-bold tracking-tight uppercase text-amber-800">SPRUCE UP LIVING</span>
    </a>

    <!-- Desktop Nav -->
    <nav class="hidden md:flex items-center gap-7 text-sm font-medium" aria-label="Primary">
      <!-- render links loaded from Firestore, show dropdown if subcategories exist -->
      <ng-container *ngFor="let link of links()">
        <div *ngIf="link.subcategories?.length; else singleLink" class="relative group">
          <button
            class="flex items-center gap-1 text-amber-700 hover:text-amber-900 pb-1 relative after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-gradient-to-r after:from-orange-400 after:to-pink-400 after:rounded-full after:transition-all after:duration-300 hover:after:w-full group"
            type="button"
            aria-haspopup="true"
            aria-expanded="false"
          >
            {{ link.label }}
            <svg class="w-3.5 h-3.5 transition-transform duration-200 group-hover:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>

          <!-- hover-bridge -->
          <div class="absolute left-0 top-full h-3 w-56"></div>

          <div
            class="absolute top-full left-0 mt-2 w-56 bg-white/95 backdrop-blur-md py-2 px-2 rounded-2xl shadow-2xl shadow-black/10 border border-white/50
                   opacity-0 invisible scale-95 transition-all duration-200 origin-top
                   group-hover:opacity-100 group-hover:visible group-hover:scale-100"
            role="menu"
          >
            <a *ngFor="let sub of link.subcategories"
               [href]="sub.href"
               class="block px-3 py-2 rounded-xl text-sm text-slate-700 hover:bg-amber-50/80 transition-colors">
              {{ sub.label }}
            </a>
          </div>
        </div>

        <ng-template #singleLink>
          <a
            [href]="link.href"
            class="relative pb-1 text-amber-700 hover:text-amber-900 after:absolute after:bottom-0 after:left-0 after:w-0 after:h-0.5 after:bg-gradient-to-r after:from-orange-400 after:to-pink-400 after:rounded-full after:transition-all after:duration-300 hover:after:w-full"
          >
            {{ link.label }}
          </a>
        </ng-template>
      </ng-container>

      <!-- Categories Dropdown (Tailwind-only: hover + focus) -->
      <div class="relative group">

        <!-- hover-bridge to prevent flicker -->
        <div class="absolute left-0 top-full h-3 w-56"></div>

        <div
          id="categories-dropdown"
          class="absolute top-full left-0 mt-2 w-56 bg-white/95 backdrop-blur-md py-2 px-2 rounded-2xl shadow-2xl shadow-black/10 border border-white/50
                 opacity-0 invisible scale-95 transition-all duration-200 origin-top
                 group-hover:opacity-100 group-hover:visible group-hover:scale-100
                 group-focus-within:opacity-100 group-focus-within:visible group-focus-within:scale-100"
          role="menu"
          aria-labelledby="categories-toggle"
        >
          <!-- dynamic categories & subcategories -->
          <ng-container *ngFor="let cat of categories()">
            <a [href]="cat.href" role="menuitem"
               class="flex items-center justify-between px-3 py-2.5 rounded-xl text-sm font-medium text-slate-800 hover:bg-amber-50/80 transition-colors duration-200">
              {{ cat.label }}
              <span *ngIf="cat.subcategories?.length" class="text-xs text-amber-600 font-medium">
                {{ cat.subcategories.length }} topics
              </span>
            </a>

            <ng-container *ngIf="cat.subcategories?.length">
              <div class="px-3 pb-2">
                <a *ngFor="let sub of cat.subcategories"
                   [href]="sub.href"
                   class="block px-3 py-2 rounded-xl text-sm text-slate-700 hover:bg-amber-50/80 transition-colors">
                  {{ sub.label }}
                </a>
              </div>
            </ng-container>
          </ng-container>
        </div>
      </div>

      <a href="#" class="px-4 py-1.5 rounded-full border border-amber-300/50 bg-gradient-to-r from-amber-100/80 to-amber-200/80 text-amber-800 text-xs font-semibold shadow-sm shadow-amber-200/50 hover:shadow-md hover:shadow-amber-300/60 hover:bg-amber-200/90 transition-all duration-300 hover:scale-[1.02] active:scale-[0.98]">
        Work with me
      </a>
    </nav>

    <!-- Mobile Toggle -->
    <label
      for="mobile-nav"
      class="md:hidden p-2 rounded-xl text-amber-700 hover:bg-amber-200/50 hover:text-amber-900 transition-all duration-200 cursor-pointer"
      aria-label="Toggle menu"
    >
      <svg class="w-6 h-6 peer-checked:hidden" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16"></path>
      </svg>

      <!-- close icon -->
      <svg class="w-6 h-6 hidden peer-checked:block" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
      </svg>
    </label>
  </div>

  <!-- Mobile Backdrop (tap to close) -->
  <label
    for="mobile-nav"
    class="fixed inset-0 bg-black/30 opacity-0 invisible transition-opacity duration-200 peer-checked:opacity-100 peer-checked:visible md:hidden"
    aria-hidden="true"
  ></label>

  <!-- Mobile Menu Panel -->
  <nav
    class="md:hidden fixed top-[60px] left-0 right-0 mx-4 rounded-3xl border border-white/60 bg-white/95 backdrop-blur-md shadow-2xl shadow-black/10
           translate-y-[-8px] opacity-0 invisible transition-all duration-200
           peer-checked:translate-y-0 peer-checked:opacity-100 peer-checked:visible"
    aria-label="Mobile primary"
  >
    <div class="p-2">
      <!-- dynamic mobile menu: render links and their subitems -->
      <ng-container *ngFor="let link of links()">
        <ng-container *ngIf="link.subcategories?.length; else singleMobileLink">
          <details class="group rounded-2xl">
            <summary
              class="list-none cursor-pointer px-4 py-3 rounded-2xl text-sm font-semibold text-slate-800 hover:bg-amber-50/80 transition-colors flex items-center justify-between"
            >
              {{ link.label }}
              <svg class="w-4 h-4 transition-transform group-open:rotate-180" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                <path stroke-linecap="round" stroke-linejoin="round" d="M19 9l-7 7-7-7"></path>
              </svg>
            </summary>

            <div class="px-2 pb-2">
              <ng-container *ngFor="let sub of link.subcategories">
                <a [href]="sub.href" class="block px-3 py-2 rounded-xl text-sm text-slate-700 hover:bg-amber-50/80 pl-6">
                  {{ sub.label }}
                </a>
              </ng-container>
            </div>
          </details>
        </ng-container>

        <ng-template #singleMobileLink>
          <a [href]="link.href" class="block px-4 py-3 rounded-2xl text-sm font-semibold text-slate-800 hover:bg-amber-50/80 transition-colors">
            {{ link.label }}
          </a>
        </ng-template>
      </ng-container>

      <div class="p-2">
        <a
          href="#"
          class="block text-center px-4 py-3 rounded-2xl border border-amber-300/50 bg-gradient-to-r from-amber-100/80 to-amber-200/80 text-amber-800 text-sm font-semibold shadow-sm shadow-amber-200/50 hover:shadow-md hover:shadow-amber-300/60 hover:bg-amber-200/90 transition-all duration-300"
        >
          Work with me
        </a>
      </div>
    </div>
  </nav>
</header>
